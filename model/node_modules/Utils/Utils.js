var fs = require('fs');
// var babyparse = require('babyparse');
// var present = require('present');

var erpWriter = function(erp, filename, header) {
var supp = erp.support([]);
var csvFile = fs.openSync(filename, 'w');
fs.writeSync(csvFile,header + ',Probability\n')
supp.forEach(function(s) {supportWriter(s, Math.exp(erp.score(s)), csvFile);})
fs.closeSync(csvFile);
};


var supportWriter = function(s, p, handle) {
// var sLst = _.pairs(s);
// var l = sLst.length;

// for (var i = 0; i < l; i++) {
//   fs.writeSync(handle, sLst[i].join(',')+','+p+'\n');
// }
fs.writeSync(handle, "'" + JSON.stringify(s) + "'" + "," + p + '\n')
};


// e.g. utils.erpWriter(posteriorERP, “filename”, “Item,Value")

module.exports = {
  supportWriter:supportWriter,
  erpWriter:erpWriter
};